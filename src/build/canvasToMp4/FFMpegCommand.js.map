{"version":3,"file":"FFMpegCommand.js","sourceRoot":"","sources":["../../canvasToMp4/FFMpegCommand.ts"],"names":[],"mappings":"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","sourcesContent":["class FFmpegCommand {\r\n\r\n  public values:string[] = [];\r\n  public width:number;\r\n  public height:number;\r\n  public encoderType:string;\r\n  public nbFrameTotal:number;\r\n\r\n\r\n  constructor(config:any){\r\n\r\n    var width,height,fps,encoderType,fileName,inputPath,durationInSeconds;\r\n    if(config.width) this.width = width = config.width;\r\n    else this.width = width = 1920;\r\n\r\n    if(config.height) this.height = height = config.height;\r\n    else this.height = height = 1080;\r\n\r\n    if(config.fps) fps = config.fps;\r\n    else fps = config.fps;\r\n\r\n    if(config.durationInSeconds) durationInSeconds = config.durationInSeconds;\r\n    else durationInSeconds = 1;\r\n\r\n    if(config.encoderType) this.encoderType = encoderType = config.encoderType;\r\n    else encoderType = \"h264_nvenc\";\r\n\r\n    if(config.fileName) fileName = config.fileName;\r\n    else fileName = \"output.mp4\";\r\n\r\n    if(config.inputPath) inputPath = config.inputPath;\r\n    else inputPath = null;\r\n\r\n    let vflip = \"\";\r\n    if(config.verticalFlip) vflip = \"-vf vflip\";\r\n\r\n\r\n    this.nbFrameTotal = Math.ceil(fps * durationInSeconds);\r\n\r\n\r\n    if(encoderType == \"libx264\"){\r\n      this.values = (\"-hwaccel cuvid -y -f rawvideo -r \"+fps+\" -s \"+width+\"x\"+height+\" -pix_fmt rgb0 -i - -c:v libx264 \"+vflip+\" -pix_fmt yuv420p -profile:v baseline -preset slow \"+fileName).split(\"  \").join(\" \").split(\" \");\r\n    }else if(encoderType == \"libx265\"){\r\n      this.values = (\"-hwaccel cuvid -y -f rawvideo -r \"+fps+\" -s \"+width+\"x\"+height+\" -pix_fmt rgb0 -i - -c:v libx265 \"+vflip+\" -pix_fmt yuv420p -profile:v main -preset slow -crf 22 \"+fileName).split(\"  \").join(\" \").split(\" \");\r\n    }else if(encoderType == \"h264_nvenc\"){\r\n      this.values = (\"-hwaccel cuvid -y -f rawvideo -r \"+fps+\" -s \"+width+\"x\"+height+\" -pix_fmt rgb0 -i - -c:v h264_nvenc \"+vflip+\" -pixel_format yuv420p -rc constqp -preset slow -profile:v baseline -crf 22 \"+fileName).split(\"  \").join(\" \").split(\" \"); //ok\r\n    }else if(encoderType == \"png\"){\r\n      this.values = (\"-hwaccel cuvid -y -f rawvideo -r \"+fps+\" -s \"+width+\"x\"+height+\" -pix_fmt rgb0 -i - \"+vflip+\" \"+fileName).split(\"  \").join(\" \").split(\" \"); //ok\r\n    }else if(encoderType == \"pngToMp4\"){\r\n      this.values = (\"-hwaccel cuvid -y -r \"+fps+\" -i \"+inputPath+\" \"+vflip+\" -c:v h264_nvenc -pixel_format yuv420p -rc constqp -preset slow -profile:v baseline -crf 22 \"+fileName).split(\"  \").join(\" \").split(\" \"); //ok\r\n    }\r\n\r\n    console.log(this.values)\r\n  }\r\n\r\n\r\n\r\n}\r\n"]}